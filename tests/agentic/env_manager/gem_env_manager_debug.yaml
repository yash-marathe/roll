defaults:
  - ../../../examples/config/step_envs.yaml@_here_


rollout_batch_size: 32
sequence_length: 8192
pretrain: Qwen/Qwen2.5-0.5B-Instruct

# Here, you can override variables defined in the imported envs. max_tokens_per_step: 128 in custom_env.SimpleSokoban, here replaced by 64
max_tokens_per_step: 64

train_env_manager:
  format_penalty: -0.15 # sokoban env penalty_for_step=-0.1
  max_env_num_per_worker: 1
  num_env_groups: 1
  # under the same group, the env config and env seed are ensured to be equal
  group_size: 1
  tags: [LetterCounting]
  num_groups_partition: [1] # If not set, all env names divide nums equally. Under the same group, the env config and env seed (prompt) are equal in each generation
  llm_proxy:
    proxy_type: random
#  llm_proxy:
#    proxy_type: openai
#    proxy_config:
#      base_url: https://offline-whale-wave.alibaba-inc.com/api/v2/services/aigc/text-generation/v1/chat/completions
#      api_key: xxx
#      model_name: Qwen2.5-72B-Instruct-Chatflow


val_env_manager:
  max_env_num_per_worker: 1
  num_env_groups: 1
  group_size: 1
  tags: [LetterCounting]
  num_groups_partition: [1] # If not set, all env names divide nums equally. Under the same group, the env config and env seed (prompt) are equal in each generation
  llm_proxy:
    proxy_type: random

actor_infer:
  generating_args:
    max_new_tokens: 128 # single-turn response length
    top_p: 0.99
    top_k: 100
    num_beams: 1
    temperature: 0.99
    num_return_sequences: 1


max_actions_per_traj: 100
default_history_length: ${max_actions_per_traj}
env_manager_cls: roll.pipeline.agentic.env_manager.step_env_manager.StepEnvManager
custom_envs:
  GuessTheNumber:
    env_type: game:GuessTheNumber-v0 # Based on default/first registration
    max_steps: ${max_actions_per_traj}
    max_tokens_per_step: ${max_tokens_per_step}
    env_manager_cls: ${env_manager_cls}
    use_thread_lock: true
    history_length: ${default_history_length}
    agent_system_template: ${agent_system_template}
    agent_template: ${agent_template}
    env_config:
      min_number: 1
      max_number: 20
      max_turns: ${max_actions_per_traj} # From GuessTheNumber-v0 registration
  LetterCounting:
    env_type: "rg:leg_counting"
    max_steps: ${max_actions_per_traj}
    max_tokens_per_step: ${max_tokens_per_step}
    env_manager_cls: ${env_manager_cls}
    agent_system_template: ${rg_agent_system_template}
    agent_template: ${rg_agent_template}
    env_config:
      size: 500
      seed: 42

agent_system_template: ~

agent_template: |
  You are playing language games. Make valid actions to win.
  Observation:
  {history}
  {current_observation}
  Please reason step by step, and put your final answer within \\boxed{{}}.


rg_agent_system_template: ~
rg_agent_template: |
  {current_observation}
  Please reason step by step, and put your final answer within \\boxed{{}}, e.g. \\boxed{{A}}.
  
