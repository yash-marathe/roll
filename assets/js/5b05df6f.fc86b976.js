"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[357],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var t=i(96540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}},39773:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>g,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"Getting Started/Debugging Guide/debug_guide","title":"ROLL Debugging Guide","description":"When developing and using the ROLL framework, debugging is an essential step. This document will introduce several effective debugging methods to help you quickly locate and resolve issues.","source":"@site/docs/Getting Started/Debugging Guide/debug_guide.md","sourceDirName":"Getting Started/Debugging Guide","slug":"/Getting Started/Debugging Guide/debug_guide","permalink":"/ROLL/docs/Getting Started/Debugging Guide/debug_guide","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/Getting Started/Debugging Guide/debug_guide.md","tags":[],"version":"current","lastUpdatedAt":1764581625000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Quick Start: Single-Node Deployment Guide","permalink":"/ROLL/docs/Getting Started/Quick Start/single_node_quick_start"},"next":{"title":"Frequently Asked Questions (Q&A)","permalink":"/ROLL/docs/Getting Started/FAQ/qa_issues"}}');var s=i(74848),r=i(28453);const a={},l="ROLL Debugging Guide",g={},o=[{value:"1. Using Ray Debugger",id:"1-using-ray-debugger",level:2},{value:"Enabling Ray Debugger",id:"enabling-ray-debugger",level:3},{value:"Using Ray Debugger",id:"using-ray-debugger",level:3},{value:"2. Debugging Code in Pipeline",id:"2-debugging-code-in-pipeline",level:2},{value:"3. Local Debugging of Agentic Multi-Round Interaction Process",id:"3-local-debugging-of-agentic-multi-round-interaction-process",level:2},{value:"Using Test Scripts",id:"using-test-scripts",level:3},{value:"Running Debug Scripts",id:"running-debug-scripts",level:3},{value:"4. Other Debugging Techniques",id:"4-other-debugging-techniques",level:2},{value:"Log Debugging [TODO]",id:"log-debugging-todo",level:3},{value:"Performance Analysis",id:"performance-analysis",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"roll-debugging-guide",children:"ROLL Debugging Guide"})}),"\n",(0,s.jsx)(n.p,{children:"When developing and using the ROLL framework, debugging is an essential step. This document will introduce several effective debugging methods to help you quickly locate and resolve issues."}),"\n",(0,s.jsx)(n.h2,{id:"1-using-ray-debugger",children:"1. Using Ray Debugger"}),"\n",(0,s.jsx)(n.p,{children:"ROLL is built on Ray, so you can use the debugging tools provided by Ray. Ray Debugger is a powerful tool that can help you debug distributed applications."}),"\n",(0,s.jsx)(n.h3,{id:"enabling-ray-debugger",children:"Enabling Ray Debugger"}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"roll/utils/ray_utils.py"})," file, you can enable Ray Debugger by setting environment variables:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# For debugging\nenv_vars["RAY_DEBUG"] = "legacy"\n'})}),"\n",(0,s.jsx)(n.p,{children:"You can set this environment variable before starting the training script:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export RAY_DEBUG=legacy\n"})}),"\n",(0,s.jsx)(n.h3,{id:"using-ray-debugger",children:"Using Ray Debugger"}),"\n",(0,s.jsx)(n.p,{children:"After enabling Ray Debugger, you can use standard Python debuggers (such as pdb) for step-by-step debugging. When the program reaches a breakpoint, the debugger will pause execution, allowing you to inspect variables, call stacks, and other information."}),"\n",(0,s.jsxs)(n.p,{children:["For detailed usage of Ray Debugger, please refer to the official documentation:\n",(0,s.jsx)(n.a,{href:"https://docs.ray.io/en/latest/ray-observability/user-guides/debug-apps/ray-debugging.html",children:"Ray Debugging Documentation"})]}),"\n",(0,s.jsx)(n.h2,{id:"2-debugging-code-in-pipeline",children:"2. Debugging Code in Pipeline"}),"\n",(0,s.jsx)(n.p,{children:"Since the Pipeline runs directly in Ray's driver, you can directly use pdb for debugging. To add breakpoints, use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import pdb; pdb.set_trace()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Do not use breakpoint() in the pipeline. In Ray debug mode, breakpoint() in the driver will not enter pdb."}),"\n",(0,s.jsx)(n.h2,{id:"3-local-debugging-of-agentic-multi-round-interaction-process",children:"3. Local Debugging of Agentic Multi-Round Interaction Process"}),"\n",(0,s.jsx)(n.p,{children:"One feature of the ROLL framework is support for debugging the Agentic multi-round interaction process. This is very helpful for developing and optimizing Agentic applications."}),"\n",(0,s.jsx)(n.h3,{id:"using-test-scripts",children:"Using Test Scripts"}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"tests/agentic/env_manager/test_traj_env_manager.py"})," file, test demo scripts for locally debugging the Agentic multi-round interaction process are provided, which you can extend with new tests."]}),"\n",(0,s.jsx)(n.p,{children:"The script includes the following functions:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"test_debug_traj_env_manager()"})," - Debug trajectory environment manager"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"test_debug_vl_traj_env_manager()"})," - Debug vision-language trajectory environment manager"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"test_debug_step_env_manager()"})," - Debug step environment manager"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"running-debug-scripts",children:"Running Debug Scripts"}),"\n",(0,s.jsx)(n.p,{children:"To run the debug script, follow these steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create and activate a Python environment:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"conda create -n python310_torch260_em python=3.10\nconda activate python310_torch260_em\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"Install dependencies:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip3 install torch torchvision torchaudio py-cpuinfo\npip install -r requirements_em_local_debug.txt\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"Run the test script:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python tests/agentic/env_manager/test_traj_env_manager.py\n"})}),"\n",(0,s.jsx)(n.p,{children:"Through this approach, you can locally debug the Agentic multi-round interaction process, significantly improving the actual development efficiency of Agentic applications."}),"\n",(0,s.jsx)(n.h2,{id:"4-other-debugging-techniques",children:"4. Other Debugging Techniques"}),"\n",(0,s.jsx)(n.h3,{id:"log-debugging-todo",children:"Log Debugging [TODO]"}),"\n",(0,s.jsx)(n.p,{children:"The ROLL framework has a built-in detailed logging system. You can obtain more debugging information by adjusting the log level:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Set log level in configuration file\nsystem_envs:\n  ROLL_LOG_LEVEL: "DEBUG"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"performance-analysis",children:"Performance Analysis"}),"\n",(0,s.jsx)(n.p,{children:"To get the training timeline, you can enable profiling in the YAML configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'system_envs:\n  RAY_PROFILING: "1"\nprofiler_output_dir: /data/oss_bucket_0/llm/profile/${exp_name}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Then use the ",(0,s.jsx)(n.a,{href:"https://ui.perfetto.dev/",children:"Perfetto UI"})," tool for analysis."]}),"\n",(0,s.jsx)(n.p,{children:"By properly using these debugging methods, you can more efficiently develop and optimize applications based on the ROLL framework."})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);