"use strict";(self.webpackChunkdocs_roll=self.webpackChunkdocs_roll||[]).push([[902],{3266:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>l,metadata:()=>p,toc:()=>g});var t=i(8168),a=(i(6540),i(5680));const l={},r="Distill Pipeline",p={unversionedId:"English/StepByStep/distill_pipeline_start",id:"English/StepByStep/distill_pipeline_start",title:"Distill Pipeline",description:"Table of Contents",source:"@site/docs/English/StepByStep/distill_pipeline_start.md",sourceDirName:"English/StepByStep",slug:"/English/StepByStep/distill_pipeline_start",permalink:"/ROLL/docs/English/StepByStep/distill_pipeline_start",draft:!1,editUrl:"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/English/StepByStep/distill_pipeline_start.md",tags:[],version:"current",lastUpdatedAt:1755156639,formattedLastUpdatedAt:"Aug 14, 2025",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Comprehensive Guide: Using the Agentic Part of ROLL",permalink:"/ROLL/docs/English/StepByStep/agent_pipeline_start"},next:{title:"RLVR Pipeline",permalink:"/ROLL/docs/English/StepByStep/rlvr_pipeline_start"}},o={},g=[{value:"\u2728\ufe0fOverview",id:"\ufe0foverview",level:2},{value:"\u2728\ufe0fCore Components",id:"\ufe0fcore-components",level:2},{value:"Main Module (<code>DistillPipeline</code>)",id:"main-module-distillpipeline",level:3},{value:"Configuration File (<code>DistillConfig</code>)",id:"configuration-file-distillconfig",level:3},{value:"Configuration File Structure and Organization",id:"configuration-file-structure-and-organization",level:4},{value:"\u2728\ufe0fData Preparation",id:"\ufe0fdata-preparation",level:2},{value:"Data Format",id:"data-format",level:3},{value:"Required Columns",id:"required-columns",level:3},{value:"\u2728\ufe0fRunning the Pipeline",id:"\ufe0frunning-the-pipeline",level:2},{value:"Method 1: Using Python Launcher Script",id:"method-1-using-python-launcher-script",level:3},{value:"Method 2: Using Helper Shell Scripts",id:"method-2-using-helper-shell-scripts",level:3},{value:"\u2728\ufe0fStep-by-Step Example",id:"\ufe0fstep-by-step-example",level:2},{value:"Step 1: Configure Settings",id:"step-1-configure-settings",level:3},{value:"Step 2: Prepare Environment and Dependencies",id:"step-2-prepare-environment-and-dependencies",level:3},{value:"Step 3: Launch the Pipeline",id:"step-3-launch-the-pipeline",level:3},{value:"Step 4: Monitoring",id:"step-4-monitoring",level:3},{value:"Step 5: Outputs and Results",id:"step-5-outputs-and-results",level:3}],s={toc:g},m="wrapper";function d({components:e,...n}){return(0,a.yg)(m,(0,t.A)({},s,n,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"distill-pipeline"},"Distill Pipeline"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Table of Contents")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#distill-pipeline"},"Distill Pipeline"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#%EF%B8%8Foverview"},"\u2728\ufe0fOverview")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#%EF%B8%8Fcore-components"},"\u2728\ufe0fCore Components"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#main-module-distillpipeline"},"Main Module (",(0,a.yg)("inlineCode",{parentName:"a"},"DistillPipeline"),")")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#configuration-file-distillconfig"},"Configuration File (",(0,a.yg)("inlineCode",{parentName:"a"},"DistillConfig"),")"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#configuration-file-structure-and-organization"},"Configuration File Structure and Organization")))))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#%EF%B8%8Fdata-preparation"},"\u2728\ufe0fData Preparation"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#data-format"},"Data Format"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#common-data-fields"},"Common Data Fields")))))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#%EF%B8%8Frunning-the-pipeline"},"\u2728\ufe0fRunning the Pipeline"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#method-1-using-python-launcher-script"},"Method 1: Using Python Launcher Script")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#method-2-using-helper-shell-scripts"},"Method 2: Using Helper Shell Scripts")))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#%EF%B8%8Fstep-by-step-example"},"\u2728\ufe0fStep-by-Step Example"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#step-1-configure-settings"},"Step 1: Configure Settings")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#step-2-prepare-environment-and-dependencies"},"Step 2: Prepare Environment and Dependencies")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#step-3-launch-the-pipeline"},"Step 3: Launch the Pipeline")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#step-4-monitoring"},"Step 4: Monitoring")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#step-5-outputs-and-results"},"Step 5: Outputs and Results"))))))),(0,a.yg)("hr",null),(0,a.yg)("h2",{id:"\ufe0foverview"},"\u2728\ufe0fOverview"),(0,a.yg)("p",null," This pipeline offers the following core advantages:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Various distillation losses"),": Support for training the model with different distillation losses and finer-grained configuration via the corresponding parameters.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Comprehensive Performance Monitoring"),": Fine-grained metric tracking system that monitors performance metrics, providing comprehensive visualization and analysis capabilities for the model training process.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Efficient Distributed Computing"),": Leverages the ",(0,a.yg)("a",{parentName:"p",href:"https://www.ray.io/"},"Ray")," framework to implement efficient distributed training on large-scale GPU clusters, significantly improving training speed and resource utilization."))),(0,a.yg)("hr",null),(0,a.yg)("h2",{id:"\ufe0fcore-components"},"\u2728\ufe0fCore Components"),(0,a.yg)("h3",{id:"main-module-distillpipeline"},"Main Module (",(0,a.yg)("inlineCode",{parentName:"h3"},"DistillPipeline"),")"),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"DistillPipeline")," (located in ",(0,a.yg)("inlineCode",{parentName:"p"},"roll/pipeline/distill/distill_pipeline.py"),") is the primary coordinator for the entire distill training process. It manages the complete training workflow, including:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Initializing and managing distributed workers (Student and Teacher workers)."),(0,a.yg)("li",{parentName:"ul"},"Coordinating data collection and processing."),(0,a.yg)("li",{parentName:"ul"},"Executing model training steps."),(0,a.yg)("li",{parentName:"ul"},"Handling checkpoint saving."),(0,a.yg)("li",{parentName:"ul"},"Recording metrics and experiment tracking.")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Source code"),": ",(0,a.yg)("inlineCode",{parentName:"p"},"roll/pipeline/distill/distill_pipeline.py")),(0,a.yg)("hr",null),(0,a.yg)("h3",{id:"configuration-file-distillconfig"},"Configuration File (",(0,a.yg)("inlineCode",{parentName:"h3"},"DistillConfig"),")"),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"DistillConfig")," (defined in ",(0,a.yg)("inlineCode",{parentName:"p"},"roll/pipeline/distill/distill_config.py"),") is a Pydantic/dataclass-based configuration object used to specify all parameters for running the distill pipeline. This configuration system is flexibly designed, supporting configuration via YAML files and managed using the Hydra framework."),(0,a.yg)("h4",{id:"configuration-file-structure-and-organization"},"Configuration File Structure and Organization"),(0,a.yg)("p",null,"Configuration files (such as ",(0,a.yg)("inlineCode",{parentName:"p"},"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"),") are organized by functional modules, containing the following main sections:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Experiment Basic Settings")),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"exp_name"),": Experiment name, used to identify a specific training run"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"logging_dir"),": Path for saving log files"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"output_dir"),": Path for saving model checkpoints and output files"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Training Control Parameters")),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"max_steps"),": Maximum number of training steps"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"save_steps"),": Frequency for saving model checkpoints"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"logging_steps"),": Frequency for recording training metrics"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"resume_from_checkpoint"),": Whether to continue training from a checkpoint. Set it to the checkpoint path if you want to resume; otherwise, set it to ",(0,a.yg)("inlineCode",{parentName:"li"},"False"),"."))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Model Configuration")),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"student_pretrain"),": Path to pre-trained weights for Student model"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"teacher_pretrain"),": Path to pre-trained weights for Teacher model"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Distill Algorithm Parameters")),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"distill_loss_weight"),": Fraction of the total loss assigned to the distillation term (SFT loss weight is 1 \u2212 this value).  "),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"kd_temperature"),": Soft-max temperature applied to the student logits during knowledge distillation.  "),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"teacher_temperature"),": Temperature applied to the teacher logits to control their softness.  "),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"kd_objective"),": Divergence measure used to compare student and teacher distributions (e.g., ",(0,a.yg)("inlineCode",{parentName:"li"},"forward_kl"),", ",(0,a.yg)("inlineCode",{parentName:"li"},"reverse_kl"),").  "),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"adaptive_kl_alpha"),": Weighting factor that blends forward and reverse KL when ",(0,a.yg)("inlineCode",{parentName:"li"},"kd_objective")," is ",(0,a.yg)("inlineCode",{parentName:"li"},"adaptive_kl"),".  "),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"skew_lambda"),": Skewing coefficient applied in ",(0,a.yg)("inlineCode",{parentName:"li"},"skewed_forward_kl")," or ",(0,a.yg)("inlineCode",{parentName:"li"},"skewed_reverse_kl")," objectives."))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Worker Configuration"),"\nEach worker (",(0,a.yg)("inlineCode",{parentName:"p"},"student"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"teacher"),") configuration contains:"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Model Parameters")," (",(0,a.yg)("inlineCode",{parentName:"li"},"model_args"),")",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"model_type"),": Model type (e.g., ",(0,a.yg)("inlineCode",{parentName:"li"},"causal_lm"),")"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"dtype"),": Computation precision (e.g., ",(0,a.yg)("inlineCode",{parentName:"li"},"bf16"),", ",(0,a.yg)("inlineCode",{parentName:"li"},"fp16"),")"),(0,a.yg)("li",{parentName:"ul"},"..."))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Training Parameters")," (",(0,a.yg)("inlineCode",{parentName:"li"},"training_args"),")",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"learning_rate"),": Learning rate"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"per_device_train_batch_size"),": Training batch size per device"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"gradient_accumulation_steps"),": Gradient accumulation steps"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"weight_decay"),": Weight decay coefficient"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"max_grad_norm"),": Gradient clipping threshold"),(0,a.yg)("li",{parentName:"ul"},"..."))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Distributed Strategy")," (",(0,a.yg)("inlineCode",{parentName:"li"},"strategy_args"),")",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"strategy_name"),": Distributed strategy to use (e.g., ",(0,a.yg)("inlineCode",{parentName:"li"},"megatron_train"),", ",(0,a.yg)("inlineCode",{parentName:"li"},"deepspeed_infer"),")"),(0,a.yg)("li",{parentName:"ul"},"Strategy-specific parameters: e.g., ",(0,a.yg)("inlineCode",{parentName:"li"},"tp_size")," (tensor parallelism size), ",(0,a.yg)("inlineCode",{parentName:"li"},"pp_size")," (pipeline parallelism size)"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"gpu_memory_utilization"),": GPU memory utilization (vLLM-specific)"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Device Mapping")," (",(0,a.yg)("inlineCode",{parentName:"li"},"device_mapping"),")",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Specifies which GPU devices the worker should use")))))),(0,a.yg)("hr",null),(0,a.yg)("h2",{id:"\ufe0fdata-preparation"},"\u2728\ufe0fData Preparation"),(0,a.yg)("h3",{id:"data-format"},"Data Format"),(0,a.yg)("p",null,"The distill pipeline expects the training data to be stored in ",(0,a.yg)("strong",{parentName:"p"},"JSON")," files."),(0,a.yg)("h3",{id:"required-columns"},"Required Columns"),(0,a.yg)("p",null,"Each data sample must contain a question and its corresponding answer.",(0,a.yg)("br",{parentName:"p"}),"\n","In the YAML file, use the keys ",(0,a.yg)("inlineCode",{parentName:"p"},"question_key")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"answer_key")," to specify the field names that hold these two pieces of data."),(0,a.yg)("hr",null),(0,a.yg)("h2",{id:"\ufe0frunning-the-pipeline"},"\u2728\ufe0fRunning the Pipeline"),(0,a.yg)("h3",{id:"method-1-using-python-launcher-script"},"Method 1: Using Python Launcher Script"),(0,a.yg)("p",null,"The primary method is to use the ",(0,a.yg)("inlineCode",{parentName:"p"},"examples/start_distill_pipeline.py")," script. This script uses Hydra to load and manage configurations."),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Select or Create a Configuration File"),(0,a.yg)("br",{parentName:"p"}),"\n","Start with an example YAML (e.g., ",(0,a.yg)("inlineCode",{parentName:"p"},"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"),") or create your own configuration.")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Execute the Python Launcher Script")),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Make sure you are in the root directory of the ROLL project\n# export PYTHONPATH=$(pwd):$PYTHONPATH\n\npython examples/start_distill_pipeline.py \\\n       --config_path examples/qwen2.5-7B-distill_megatron \\\n       --config_name distill_megatron\n")),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"--config_path")," \u2013 Directory containing your YAML configuration."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"--config_name")," \u2013 Filename (without ",(0,a.yg)("inlineCode",{parentName:"li"},".yaml"),").")))),(0,a.yg)("h3",{id:"method-2-using-helper-shell-scripts"},"Method 2: Using Helper Shell Scripts"),(0,a.yg)("p",null,"The ",(0,a.yg)("inlineCode",{parentName:"p"},"examples")," directory typically contains shell scripts that wrap the Python launcher."),(0,a.yg)("p",null,"Example structure:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n# Example: examples/qwen2.5-7B-distill_megatron/run_distill_pipeline.sh\n\nCONFIG_NAME="distill_megatron"                         # distill_megatron.yaml\nCONFIG_PATH="examples/qwen2.5-7B-distill_megatron"\n\n# Set environment variables and other configurations\n\npython examples/start_distill_pipeline.py \\\n       --config_path $CONFIG_PATH \\\n       --config_name $CONFIG_NAME \\\n       "$@"   # Pass any additional parameters\n')),(0,a.yg)("p",null,"Run using:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"bash examples/qwen2.5-7B-distill_megatron/run_distill_pipeline.sh\n")),(0,a.yg)("hr",null),(0,a.yg)("h2",{id:"\ufe0fstep-by-step-example"},"\u2728\ufe0fStep-by-Step Example"),(0,a.yg)("h3",{id:"step-1-configure-settings"},"Step 1: Configure Settings"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"File: ",(0,a.yg)("inlineCode",{parentName:"p"},"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"),(0,a.yg)("br",{parentName:"p"}),"\n","Key sections include ",(0,a.yg)("inlineCode",{parentName:"p"},"exp_name"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"seed"),", ",(0,a.yg)("inlineCode",{parentName:"p"},"output_dir"),", model paths, ",(0,a.yg)("inlineCode",{parentName:"p"},"student")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"teacher")," configurations.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Pay special attention to these configuration sections:"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Data configuration: ",(0,a.yg)("inlineCode",{parentName:"li"},"student.data_args.file_name")),(0,a.yg)("li",{parentName:"ul"},"Model configuration: ",(0,a.yg)("inlineCode",{parentName:"li"},"student_pretrain")," and ",(0,a.yg)("inlineCode",{parentName:"li"},"teacher_pretrain")," paths (The distill pipeline currently only supports student and teacher models of the same type, for example, both the student and teacher models are Qwen.)"),(0,a.yg)("li",{parentName:"ul"},"Distributed strategies: ",(0,a.yg)("inlineCode",{parentName:"li"},"strategy_args")," and ",(0,a.yg)("inlineCode",{parentName:"li"},"device_mapping")," for each worker (The distillation pipeline currently only supports scenarios where the student and teacher models use the same strategy (e.g., the student uses megatron_train while the teacher uses megatron_infer) with identical parallel configurations, as we utilize CudaIPC to transfer logits from the teacher to the student.)")))),(0,a.yg)("h3",{id:"step-2-prepare-environment-and-dependencies"},"Step 2: Prepare Environment and Dependencies"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Ensure all necessary dependencies are installed:"),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"pip install -r requirements.txt\n"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Verify that all model paths in the configuration are accessible.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"Prepare training datasets, ensuring they conform to the data format requirements described above."))),(0,a.yg)("h3",{id:"step-3-launch-the-pipeline"},"Step 3: Launch the Pipeline"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python examples/start_distill_pipeline.py \\\n       --config_path examples/qwen2.5-7B-distill_megatron \\\n       --config_name distill_megatron\n")),(0,a.yg)("h3",{id:"step-4-monitoring"},"Step 4: Monitoring"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Console Output")," \u2013 Observe Hydra, Ray, and pipeline logs.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"Log Files")," \u2013 Check the ",(0,a.yg)("inlineCode",{parentName:"p"},"logging_dir")," specified in the YAML.")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},(0,a.yg)("strong",{parentName:"p"},"TensorBoard")),(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"tensorboard --logdir <your_log_dir>\n")))),(0,a.yg)("h3",{id:"step-5-outputs-and-results"},"Step 5: Outputs and Results"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Trained Models")," \u2013 Checkpoints are saved in the ",(0,a.yg)("inlineCode",{parentName:"li"},"output_dir"),"."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Evaluation Metrics")," \u2013 Recorded in TensorBoard and the console.")),(0,a.yg)("hr",null),(0,a.yg)("p",null,(0,a.yg)("em",{parentName:"p"},"Happy experimenting!")))}d.isMDXComponent=!0},5680:(e,n,i)=>{i.d(n,{xA:()=>s,yg:()=>y});var t=i(6540);function a(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function l(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,t)}return i}function r(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?l(Object(i),!0).forEach(function(n){a(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}function p(e,n){if(null==e)return{};var i,t,a=function(e,n){if(null==e)return{};var i,t,a={},l=Object.keys(e);for(t=0;t<l.length;t++)i=l[t],n.indexOf(i)>=0||(a[i]=e[i]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)i=l[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var o=t.createContext({}),g=function(e){var n=t.useContext(o),i=n;return e&&(i="function"==typeof e?e(n):r(r({},n),e)),i},s=function(e){var n=g(e.components);return t.createElement(o.Provider,{value:n},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef(function(e,n){var i=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=g(i),u=a,y=m["".concat(o,".").concat(u)]||m[u]||d[u]||l;return i?t.createElement(y,r(r({ref:n},s),{},{components:i})):t.createElement(y,r({ref:n},s))});function y(e,n){var i=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=i.length,r=new Array(l);r[0]=u;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p[m]="string"==typeof e?e:a,r[1]=p;for(var g=2;g<l;g++)r[g]=i[g];return t.createElement.apply(null,r)}return t.createElement.apply(null,i)}u.displayName="MDXCreateElement"}}]);