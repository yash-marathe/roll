"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[9241],{22502:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"User Guides/Pipeline/distill_pipeline_start","title":"Distill Pipeline","description":"Table of Contents","source":"@site/docs/User Guides/Pipeline/distill_pipeline_start.md","sourceDirName":"User Guides/Pipeline","slug":"/User Guides/Pipeline/distill_pipeline_start","permalink":"/ROLL/docs/User Guides/Pipeline/distill_pipeline_start","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/User Guides/Pipeline/distill_pipeline_start.md","tags":[],"version":"current","lastUpdatedAt":1764581625000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Agentic Pipeline","permalink":"/ROLL/docs/User Guides/Pipeline/agentic_pipeline_start"},"next":{"title":"DPO Pipeline","permalink":"/ROLL/docs/User Guides/Pipeline/dpo_pipeline_start"}}');var l=i(74848),r=i(28453);const t={},d="Distill Pipeline",c={},o=[{value:"\u2728\ufe0fOverview",id:"\ufe0foverview",level:2},{value:"\u2728\ufe0fCore Components",id:"\ufe0fcore-components",level:2},{value:"Main Module (<code>DistillPipeline</code>)",id:"main-module-distillpipeline",level:3},{value:"Configuration File (<code>DistillConfig</code>)",id:"configuration-file-distillconfig",level:3},{value:"Configuration File Structure and Organization",id:"configuration-file-structure-and-organization",level:4},{value:"\u2728\ufe0fData Preparation",id:"\ufe0fdata-preparation",level:2},{value:"Data Format",id:"data-format",level:3},{value:"Required Columns",id:"required-columns",level:3},{value:"\u2728\ufe0fRunning the Pipeline",id:"\ufe0frunning-the-pipeline",level:2},{value:"Method 1: Using Python Launcher Script",id:"method-1-using-python-launcher-script",level:3},{value:"Method 2: Using Helper Shell Scripts",id:"method-2-using-helper-shell-scripts",level:3},{value:"\u2728\ufe0fStep-by-Step Example",id:"\ufe0fstep-by-step-example",level:2},{value:"Step 1: Configure Settings",id:"step-1-configure-settings",level:3},{value:"Step 2: Prepare Environment and Dependencies",id:"step-2-prepare-environment-and-dependencies",level:3},{value:"Step 3: Launch the Pipeline",id:"step-3-launch-the-pipeline",level:3},{value:"Step 4: Monitoring",id:"step-4-monitoring",level:3},{value:"Step 5: Outputs and Results",id:"step-5-outputs-and-results",level:3}];function a(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"distill-pipeline",children:"Distill Pipeline"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Table of Contents"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#distill-pipeline",children:"Distill Pipeline"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%EF%B8%8Foverview",children:"\u2728\ufe0fOverview"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%EF%B8%8Fcore-components",children:"\u2728\ufe0fCore Components"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsxs)(n.a,{href:"#main-module-distillpipeline",children:["Main Module (",(0,l.jsx)(n.code,{children:"DistillPipeline"}),")"]})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsxs)(n.a,{href:"#configuration-file-distillconfig",children:["Configuration File (",(0,l.jsx)(n.code,{children:"DistillConfig"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#configuration-file-structure-and-organization",children:"Configuration File Structure and Organization"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%EF%B8%8Fdata-preparation",children:"\u2728\ufe0fData Preparation"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#data-format",children:"Data Format"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#common-data-fields",children:"Common Data Fields"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%EF%B8%8Frunning-the-pipeline",children:"\u2728\ufe0fRunning the Pipeline"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#method-1-using-python-launcher-script",children:"Method 1: Using Python Launcher Script"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#method-2-using-helper-shell-scripts",children:"Method 2: Using Helper Shell Scripts"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%EF%B8%8Fstep-by-step-example",children:"\u2728\ufe0fStep-by-Step Example"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#step-1-configure-settings",children:"Step 1: Configure Settings"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#step-2-prepare-environment-and-dependencies",children:"Step 2: Prepare Environment and Dependencies"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#step-3-launch-the-pipeline",children:"Step 3: Launch the Pipeline"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#step-4-monitoring",children:"Step 4: Monitoring"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#step-5-outputs-and-results",children:"Step 5: Outputs and Results"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0foverview",children:"\u2728\ufe0fOverview"}),"\n",(0,l.jsx)(n.p,{children:"This pipeline offers the following core advantages:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Various distillation losses"}),": Support for training the model with different distillation losses and finer-grained configuration via the corresponding parameters."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Comprehensive Performance Monitoring"}),": Fine-grained metric tracking system that monitors performance metrics, providing comprehensive visualization and analysis capabilities for the model training process."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Efficient Distributed Computing"}),": Leverages the ",(0,l.jsx)(n.a,{href:"https://www.ray.io/",children:"Ray"})," framework to implement efficient distributed training on large-scale GPU clusters, significantly improving training speed and resource utilization."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0fcore-components",children:"\u2728\ufe0fCore Components"}),"\n",(0,l.jsxs)(n.h3,{id:"main-module-distillpipeline",children:["Main Module (",(0,l.jsx)(n.code,{children:"DistillPipeline"}),")"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"DistillPipeline"})," (located in ",(0,l.jsx)(n.code,{children:"roll/pipeline/distill/distill_pipeline.py"}),") is the primary coordinator for the entire distill training process. It manages the complete training workflow, including:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Initializing and managing distributed workers (Student and Teacher workers)."}),"\n",(0,l.jsx)(n.li,{children:"Coordinating data collection and processing."}),"\n",(0,l.jsx)(n.li,{children:"Executing model training steps."}),"\n",(0,l.jsx)(n.li,{children:"Handling checkpoint saving."}),"\n",(0,l.jsx)(n.li,{children:"Recording metrics and experiment tracking."}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source code"}),": ",(0,l.jsx)(n.code,{children:"roll/pipeline/distill/distill_pipeline.py"})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.h3,{id:"configuration-file-distillconfig",children:["Configuration File (",(0,l.jsx)(n.code,{children:"DistillConfig"}),")"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"DistillConfig"})," (defined in ",(0,l.jsx)(n.code,{children:"roll/pipeline/distill/distill_config.py"}),") is a Pydantic/dataclass-based configuration object used to specify all parameters for running the distill pipeline. This configuration system is flexibly designed, supporting configuration via YAML files and managed using the Hydra framework."]}),"\n",(0,l.jsx)(n.h4,{id:"configuration-file-structure-and-organization",children:"Configuration File Structure and Organization"}),"\n",(0,l.jsxs)(n.p,{children:["Configuration files (such as ",(0,l.jsx)(n.code,{children:"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"}),") are organized by functional modules, containing the following main sections:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Experiment Basic Settings"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"exp_name"}),": Experiment name, used to identify a specific training run"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"logging_dir"}),": Path for saving log files"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"output_dir"}),": Path for saving model checkpoints and output files"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Training Control Parameters"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"save_steps"}),": Frequency for saving model checkpoints"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"logging_steps"}),": Frequency for recording training metrics"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"resume_from_checkpoint"}),": Whether to continue training from a checkpoint. Set it to the checkpoint path if you want to resume; otherwise, set it to ",(0,l.jsx)(n.code,{children:"False"}),"."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Model Configuration"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"student_pretrain"}),": Path to pre-trained weights for Student model"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"teacher_pretrain"}),": Path to pre-trained weights for Teacher model"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Distill Algorithm Parameters"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"distill_loss_weight"}),": Fraction of the total loss assigned to the distillation term (SFT loss weight is 1 \u2212 this value)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kd_temperature"}),": Soft-max temperature applied to the student logits during knowledge distillation."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"teacher_temperature"}),": Temperature applied to the teacher logits to control their softness."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kd_objective"}),": Divergence measure used to compare student and teacher distributions (e.g., ",(0,l.jsx)(n.code,{children:"forward_kl"}),", ",(0,l.jsx)(n.code,{children:"reverse_kl"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"adaptive_kl_alpha"}),": Weighting factor that blends forward and reverse KL when ",(0,l.jsx)(n.code,{children:"kd_objective"})," is ",(0,l.jsx)(n.code,{children:"adaptive_kl"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"skew_lambda"}),": Skewing coefficient applied in ",(0,l.jsx)(n.code,{children:"skewed_forward_kl"})," or ",(0,l.jsx)(n.code,{children:"skewed_reverse_kl"})," objectives."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Logits Transfer Configuration"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"logits_transfer_backend"}),": Backend used for logits transfer. Supports three modes: 'ipc+nccl', 'nccl-only', and 'ray'.",(0,l.jsx)(n.br,{}),"\n","'ipc+nccl' uses CUDA IPC to transfer logits directly via shared GPU memory when running on the same device.",(0,l.jsx)(n.br,{}),"\n","If the device does not support IPC, use either 'nccl-only' or 'ray' mode instead."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Worker Configuration"}),"\nEach worker (",(0,l.jsx)(n.code,{children:"student"}),", ",(0,l.jsx)(n.code,{children:"teacher"}),") configuration contains:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Model Parameters"})," (",(0,l.jsx)(n.code,{children:"model_args"}),")","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"model_type"}),": Model type (e.g., ",(0,l.jsx)(n.code,{children:"causal_lm"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"dtype"}),": Computation precision (e.g., ",(0,l.jsx)(n.code,{children:"bf16"}),", ",(0,l.jsx)(n.code,{children:"fp16"}),")"]}),"\n",(0,l.jsx)(n.li,{children:"..."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Training Parameters"})," (",(0,l.jsx)(n.code,{children:"training_args"}),")","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"num_train_epochs"}),": Num of training epochs"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"learning_rate"}),": Learning rate"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"per_device_train_batch_size"}),": Training batch size per device"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"gradient_accumulation_steps"}),": Gradient accumulation steps"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"weight_decay"}),": Weight decay coefficient"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"max_grad_norm"}),": Gradient clipping threshold"]}),"\n",(0,l.jsx)(n.li,{children:"..."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Distributed Strategy"})," (",(0,l.jsx)(n.code,{children:"strategy_args"}),")","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"strategy_name"}),": Distributed strategy to use (e.g., ",(0,l.jsx)(n.code,{children:"megatron_train"}),", ",(0,l.jsx)(n.code,{children:"deepspeed_infer"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:["Strategy-specific parameters: e.g., ",(0,l.jsx)(n.code,{children:"tp_size"})," (tensor parallelism size), ",(0,l.jsx)(n.code,{children:"pp_size"})," (pipeline parallelism size)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"gpu_memory_utilization"}),": GPU memory utilization (vLLM-specific)"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Device Mapping"})," (",(0,l.jsx)(n.code,{children:"device_mapping"}),")","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Specifies which GPU devices the worker should use"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0fdata-preparation",children:"\u2728\ufe0fData Preparation"}),"\n",(0,l.jsx)(n.h3,{id:"data-format",children:"Data Format"}),"\n",(0,l.jsxs)(n.p,{children:["The distill pipeline expects the training data to be stored in ",(0,l.jsx)(n.strong,{children:"JSON"})," files."]}),"\n",(0,l.jsx)(n.h3,{id:"required-columns",children:"Required Columns"}),"\n",(0,l.jsxs)(n.p,{children:["Each data sample must contain a question and its corresponding answer.",(0,l.jsx)(n.br,{}),"\n","In the YAML file, use the keys ",(0,l.jsx)(n.code,{children:"question_key"})," and ",(0,l.jsx)(n.code,{children:"answer_key"})," to specify the field names that hold these two pieces of data."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0frunning-the-pipeline",children:"\u2728\ufe0fRunning the Pipeline"}),"\n",(0,l.jsx)(n.h3,{id:"method-1-using-python-launcher-script",children:"Method 1: Using Python Launcher Script"}),"\n",(0,l.jsxs)(n.p,{children:["The primary method is to use the ",(0,l.jsx)(n.code,{children:"examples/start_distill_pipeline.py"})," script. This script uses Hydra to load and manage configurations."]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Select or Create a Configuration File"}),(0,l.jsx)(n.br,{}),"\n","Start with an example YAML (e.g., ",(0,l.jsx)(n.code,{children:"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"}),") or create your own configuration."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Execute the Python Launcher Script"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Make sure you are in the root directory of the ROLL project\n# export PYTHONPATH=$(pwd):$PYTHONPATH\n\npython examples/start_distill_pipeline.py \\\n       --config_path examples/qwen2.5-7B-distill_megatron \\\n       --config_name distill_megatron\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"--config_path"})," \u2013 Directory containing your YAML configuration."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"--config_name"})," \u2013 Filename (without ",(0,l.jsx)(n.code,{children:".yaml"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"method-2-using-helper-shell-scripts",children:"Method 2: Using Helper Shell Scripts"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"examples"})," directory typically contains shell scripts that wrap the Python launcher."]}),"\n",(0,l.jsx)(n.p,{children:"Example structure:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# Example: examples/qwen2.5-7B-distill_megatron/run_distill_pipeline.sh\n\nCONFIG_NAME="distill_megatron"                         # distill_megatron.yaml\nCONFIG_PATH="examples/qwen2.5-7B-distill_megatron"\n\n# Set environment variables and other configurations\n\npython examples/start_distill_pipeline.py \\\n       --config_path $CONFIG_PATH \\\n       --config_name $CONFIG_NAME \\\n       "$@"   # Pass any additional parameters\n'})}),"\n",(0,l.jsx)(n.p,{children:"Run using:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"bash examples/qwen2.5-7B-distill_megatron/run_distill_pipeline.sh\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0fstep-by-step-example",children:"\u2728\ufe0fStep-by-Step Example"}),"\n",(0,l.jsx)(n.h3,{id:"step-1-configure-settings",children:"Step 1: Configure Settings"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["File: ",(0,l.jsx)(n.code,{children:"examples/qwen2.5-7B-distill_megatron/distill_megatron.yaml"}),(0,l.jsx)(n.br,{}),"\n","Key sections include ",(0,l.jsx)(n.code,{children:"exp_name"}),", ",(0,l.jsx)(n.code,{children:"seed"}),", ",(0,l.jsx)(n.code,{children:"output_dir"}),", model paths, ",(0,l.jsx)(n.code,{children:"student"})," and ",(0,l.jsx)(n.code,{children:"teacher"})," configurations."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Pay special attention to these configuration sections:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Data configuration: ",(0,l.jsx)(n.code,{children:"student.data_args.file_name"})]}),"\n",(0,l.jsxs)(n.li,{children:["Model configuration: ",(0,l.jsx)(n.code,{children:"student_pretrain"})," and ",(0,l.jsx)(n.code,{children:"teacher_pretrain"})," paths (The distill pipeline currently only supports student and teacher models of the same type, for example, both the student and teacher models are Qwen.)"]}),"\n",(0,l.jsxs)(n.li,{children:["Distributed strategies: ",(0,l.jsx)(n.code,{children:"strategy_args"})," and ",(0,l.jsx)(n.code,{children:"device_mapping"})," for each worker"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"step-2-prepare-environment-and-dependencies",children:"Step 2: Prepare Environment and Dependencies"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Ensure all necessary dependencies are installed:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pip install -r requirements.txt\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Verify that all model paths in the configuration are accessible."}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Prepare training datasets, ensuring they conform to the data format requirements described above."}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"step-3-launch-the-pipeline",children:"Step 3: Launch the Pipeline"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python examples/start_distill_pipeline.py \\\n       --config_path examples/qwen2.5-7B-distill_megatron \\\n       --config_name distill_megatron\n"})}),"\n",(0,l.jsx)(n.h3,{id:"step-4-monitoring",children:"Step 4: Monitoring"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Console Output"})," \u2013 Observe Hydra, Ray, and pipeline logs."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Log Files"})," \u2013 Check the ",(0,l.jsx)(n.code,{children:"logging_dir"})," specified in the YAML."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"TensorBoard"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tensorboard --logdir <your_log_dir>\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"step-5-outputs-and-results",children:"Step 5: Outputs and Results"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Trained Models"})," \u2013 Checkpoints are saved in the ",(0,l.jsx)(n.code,{children:"output_dir"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Evaluation Metrics"})," \u2013 Recorded in TensorBoard and the console."]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:"Happy experimenting!"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>d});var s=i(96540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);