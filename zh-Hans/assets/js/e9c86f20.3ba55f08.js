"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[7546],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>l});var r=i(96540);const a={},t=r.createContext(a);function s(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(t.Provider,{value:n},e.children)}},74436:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"User Guides/Agentic/agentic_StarPO","title":"TrajWiseLearning\u2014\u2014StarPO (State-Thinking-Actions-Reward Policy Optimization)","description":"\u7b80\u4ecb","source":"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/User Guides/Agentic/agentic_StarPO.md","sourceDirName":"User Guides/Agentic","slug":"/User Guides/Agentic/agentic_StarPO","permalink":"/ROLL/zh-Hans/docs/User Guides/Agentic/agentic_StarPO","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/User Guides/Agentic/agentic_StarPO.md","tags":[],"version":"current","lastUpdatedAt":1764639784000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"StepWise Learning\u2014\u2014GiGPO (Group-in-Group Policy Optimization)","permalink":"/ROLL/zh-Hans/docs/User Guides/Agentic/agentic_GiGPO"},"next":{"title":"Agentic \u5de5\u7a0b\u5b9e\u8df5\u6587\u6863","permalink":"/ROLL/zh-Hans/docs/User Guides/Agentic/agentic_engineer_practice"}}');var a=i(74848),t=i(28453);const s={},l="TrajWiseLearning\u2014\u2014StarPO (State-Thinking-Actions-Reward Policy Optimization)",c={},o=[{value:"\u7b80\u4ecb",id:"\u7b80\u4ecb",level:2},{value:"StarPO \u914d\u7f6e\u53c2\u6570",id:"starpo-\u914d\u7f6e\u53c2\u6570",level:2},{value:"\u6838\u5fc3\u53c2\u6570\u8bf4\u660e",id:"\u6838\u5fc3\u53c2\u6570\u8bf4\u660e",level:3},{value:"PPO \u76f8\u5173\u53c2\u6570",id:"ppo-\u76f8\u5173\u53c2\u6570",level:3},{value:"\u73af\u5883\u7ba1\u7406\u5668\u53c2\u6570",id:"\u73af\u5883\u7ba1\u7406\u5668\u53c2\u6570",level:3},{value:"\u53c2\u8003\u793a\u4f8b",id:"\u53c2\u8003\u793a\u4f8b",level:2},{value:"\u53c2\u8003\u6587\u732e",id:"\u53c2\u8003\u6587\u732e",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"trajwiselearningstarpo-state-thinking-actions-reward-policy-optimization",children:"TrajWiseLearning\u2014\u2014StarPO (State-Thinking-Actions-Reward Policy Optimization)"})}),"\n",(0,a.jsx)(n.h2,{id:"\u7b80\u4ecb",children:"\u7b80\u4ecb"}),"\n",(0,a.jsx)(n.p,{children:"StarPO (State-Thinking-Actions-Reward Policy Optimization) \u662f\u4e00\u79cd\u7528\u4e8eLLM\u667a\u80fd\u4f53\u8bad\u7ec3\u7684\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\u3002\u5b83\u901a\u8fc7\u5c06\u6574\u4e2a\u591a\u8f6e\u4ea4\u4e92\u8f68\u8ff9\uff08\u5305\u62ec\u89c2\u5bdf\u3001\u63a8\u7406\u8f68\u8ff9\u3001\u52a8\u4f5c\u548c\u53cd\u9988\uff09\u89c6\u4e3a\u4e00\u4e2a\u8fde\u8d2f\u7684\u5355\u5143\u6765\u8fdb\u884c\u4f18\u5316\uff0c\u800c\u4e0d\u662f\u50cf\u4f20\u7edf\u65b9\u6cd5\u90a3\u6837\u72ec\u7acb\u5904\u7406\u6bcf\u4e2a\u52a8\u4f5c\u3002"}),"\n",(0,a.jsx)(n.p,{children:"StarPO\u7684\u6838\u5fc3\u601d\u60f3\u662f\u8f68\u8ff9\u7ea7\u522b\u7684\u4f18\u5316\uff0c\u5b83\u4ea4\u66ff\u8fdb\u884c\u4e24\u4e2a\u9636\u6bb5\uff1a"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Rollout\u9636\u6bb5"}),"\uff1a\u751f\u6210\u63a8\u7406-\u4ea4\u4e92\u8f68\u8ff9"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Update\u9636\u6bb5"}),"\uff1a\u57fa\u4e8e\u5b8c\u6574\u8f68\u8ff9\u8fdb\u884c\u6a21\u578b\u4f18\u5316"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"starpo-\u914d\u7f6e\u53c2\u6570",children:"StarPO \u914d\u7f6e\u53c2\u6570"}),"\n",(0,a.jsxs)(n.p,{children:["\u5728 ROLL \u4e2d\uff0cStarPO\u5b9e\u73b0\u6838\u5fc3\u4ee3\u7801\u4f4d\u4e8e",(0,a.jsx)(n.code,{children:"roll/pipeline/agentic/utils.py"}),"\uff0c\u4f7f\u7528StarPO\u7b97\u6cd5\u7279\u6709\u7684\u914d\u7f6e\u53c2\u6570\u5982\u4e0b(",(0,a.jsx)(n.code,{children:"roll.pipeline.agentic.agentic_config.AgenticConfig"}),")\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# StarPO core config\n# StarPO related\nadv_estimator: "reinforce"\n\n# rollout_batch_size\u662f\u8f68\u8ff9\u7684\u6761\u6570\nrollout_batch_size: 1024\nval_batch_size: 1024\nsequence_length: 1024\n\nadvantage_clip: 0.2\nppo_epochs: 1\n\n# pg_clip: 0.1\n#dual_clip_loss: True\ninit_kl_coef: 0.0\nwhiten_advantages: true\nentropy_loss_coef: 0\nmax_grad_norm: 1.0\n\nreward_normalization:\n  grouping: traj_group_id # \u53ef\u4ee5tags(env_type)/traj_group_id(group)/batch(rollout_batch)... group_by\u8ba1\u7b97reward/adv\n  method: mean # asym_clip / identity / mean_std / mean\n\ntrain_env_manager:\n  max_env_num_per_worker: 16\n  num_env_groups: 128\n  # under the same group, the env config and env seed are ensured to be equal\n  group_size: 8 # grpo\u7684grpo\n  tags: [FrozenLake]\n  num_groups_partition: [128] # If not set, all env names divide nums equally. Under the same group, the env config and env seed (prompt) are equal in each generation\n\nenv_manager_cls: roll.pipeline.agentic.env_manager.traj_env_manager.TrajEnvManager\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u6838\u5fc3\u53c2\u6570\u8bf4\u660e",children:"\u6838\u5fc3\u53c2\u6570\u8bf4\u660e"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"adv_estimator"}),': \u4f18\u52bf\u4f30\u8ba1\u5668\u7c7b\u578b\uff0c\u8bbe\u7f6e\u4e3a "reinforce"\uff0c\u8fd9\u662fStarPO\u7b97\u6cd5\u7684\u6838\u5fc3\u914d\u7f6e']}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"env_manager_cls"}),": \u8f68\u8ff9\u73af\u5883\u7ba1\u7406\u5668\u7c7b\uff0cStarPO\u9700\u8981\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"roll.pipeline.agentic.env_manager.traj_env_manager.TrajEnvManager"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"ppo-\u76f8\u5173\u53c2\u6570",children:"PPO \u76f8\u5173\u53c2\u6570"}),"\n",(0,a.jsx)(n.p,{children:"\u4ee5\u4e0b\u53c2\u6570\u662fPPO\u7c7b\u7b97\u6cd5\u901a\u7528\u7684\u914d\u7f6e\u9879\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"rollout_batch_size"}),": \u6bcf\u4e2arollout\u6279\u6b21\u7684\u8f68\u8ff9\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a 1024"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"val_batch_size"}),": \u9a8c\u8bc1\u6279\u6b21\u5927\u5c0f\uff0c\u9ed8\u8ba4\u503c\u4e3a 1024"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"sequence_length"}),": \u5e8f\u5217\u6700\u5927\u957f\u5ea6\uff0c\u9ed8\u8ba4\u503c\u4e3a 1024"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"advantage_clip"}),": \u4f18\u52bf\u503c\u88c1\u526a\u8303\u56f4\uff0c\u9ed8\u8ba4\u503c\u4e3a 0.2"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ppo_epochs"}),": \u6bcf\u4e2a\u6279\u6b21\u6837\u672c\u7684\u4f18\u5316\u8f6e\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 1"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"init_kl_coef"}),": KL\u60e9\u7f5a\u7684\u521d\u59cb\u7cfb\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 0.0"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"whiten_advantages"}),": \u662f\u5426\u5bf9\u4f18\u52bf\u503c\u8fdb\u884c\u767d\u5316\u5904\u7406\uff0c\u9ed8\u8ba4\u503c\u4e3a true"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"entropy_loss_coef"}),": \u71b5\u635f\u5931\u7cfb\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 0"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"max_grad_norm"}),": \u68af\u5ea6\u88c1\u526a\u7684\u6700\u5927\u8303\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 1.0"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u73af\u5883\u7ba1\u7406\u5668\u53c2\u6570",children:"\u73af\u5883\u7ba1\u7406\u5668\u53c2\u6570"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"train_env_manager.max_env_num_per_worker"}),": \u6bcf\u4e2a\u5de5\u4f5c\u8fdb\u7a0b\u7684\u6700\u5927\u73af\u5883\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 16"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"train_env_manager.num_env_groups"}),": \u8bad\u7ec3\u73af\u5883\u7ec4\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a 128"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"train_env_manager.group_size"}),": \u6bcf\u7ec4\u73af\u5883\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a 8"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"train_env_manager.tags"}),": \u73af\u5883\u6807\u7b7e\u5217\u8868\uff0c\u9ed8\u8ba4\u503c\u4e3a [FrozenLake]"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"train_env_manager.num_groups_partition"}),": \u5404\u73af\u5883\u7c7b\u578b\u7684\u7ec4\u6570\u5206\u914d\uff0c\u9ed8\u8ba4\u503c\u4e3a [128]"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u53c2\u8003\u793a\u4f8b",children:"\u53c2\u8003\u793a\u4f8b"}),"\n",(0,a.jsx)(n.p,{children:"\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u914d\u7f6e\u6587\u4ef6\u6765\u8bbe\u7f6e StarPO \u8bad\u7ec3\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"./examples/qwen2.5-0.5B-agentic/agent_val_frozen_lake.yaml"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u53c2\u8003\u6587\u732e",children:"\u53c2\u8003\u6587\u732e"}),"\n",(0,a.jsx)(n.p,{children:"[1] Liu, T.; Feng, L.; An, B. StarPO: State-Regularized Policy Optimization for LLM Agent Training. arXiv 2025, 2504.20073."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);