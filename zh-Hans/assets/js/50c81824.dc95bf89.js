"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[2604],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>i});var l=r(96540);const d={},s=l.createContext(d);function t(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),l.createElement(s.Provider,{value:n},e.children)}},71543:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>o,frontMatter:()=>t,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"User Guides/Hardware Support/ascend_usage","title":"ROLL x Ascend","description":"Last updated: 09/28/2025.","source":"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/User Guides/Hardware Support/ascend_usage.md","sourceDirName":"User Guides/Hardware Support","slug":"/User Guides/Hardware Support/ascend_usage","permalink":"/ROLL/zh-Hans/docs/User Guides/Hardware Support/ascend_usage","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/User Guides/Hardware Support/ascend_usage.md","tags":[],"version":"current","lastUpdatedAt":1764223793000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"tracker\u548cmetrics","permalink":"/ROLL/zh-Hans/docs/User Guides/Tracker & Metrics/trackers_and_metrics"},"next":{"title":"AgenticPipeline","permalink":"/ROLL/zh-Hans/docs/Development/Architecture/AgenticPipeline"}}');var d=r(74848),s=r(28453);const t={},i="ROLL x Ascend",c={},a=[{value:"\u786c\u4ef6\u652f\u6301",id:"\u786c\u4ef6\u652f\u6301",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u57fa\u7840\u73af\u5883\u51c6\u5907",id:"\u57fa\u7840\u73af\u5883\u51c6\u5907",level:3},{value:"\u521b\u5efa conda \u73af\u5883",id:"\u521b\u5efa-conda-\u73af\u5883",level:3},{value:"\u5b89\u88c5 torch &amp; torch_npu:",id:"\u5b89\u88c5-torch--torch_npu",level:3},{value:"\u5b89\u88c5vllm &amp; vllm-ascend:",id:"\u5b89\u88c5vllm--vllm-ascend",level:3},{value:"\u5b89\u88c5 ROLL",id:"\u5b89\u88c5-roll",level:3},{value:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e",id:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e",level:3},{value:"\u5feb\u901f\u5f00\u59cb\uff0c\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15",id:"\u5feb\u901f\u5f00\u59cb\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15",level:2},{value:"\u652f\u6301\u73b0\u72b6",id:"\u652f\u6301\u73b0\u72b6",level:2},{value:"\u58f0\u660e",id:"\u58f0\u660e",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"roll-x-ascend",children:"ROLL x Ascend"})}),"\n",(0,d.jsx)(n.p,{children:"Last updated: 09/28/2025."}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4eec\u5728 ROLL \u4e0a\u589e\u52a0\u5bf9\u534e\u4e3a\u6607\u817e\u8bbe\u5907\u7684\u652f\u6301\u3002"}),"\n",(0,d.jsx)(n.h2,{id:"\u786c\u4ef6\u652f\u6301",children:"\u786c\u4ef6\u652f\u6301"}),"\n",(0,d.jsx)(n.p,{children:"Atlas 900 A2 PODc"}),"\n",(0,d.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,d.jsx)(n.h3,{id:"\u57fa\u7840\u73af\u5883\u51c6\u5907",children:"\u57fa\u7840\u73af\u5883\u51c6\u5907"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"software"}),(0,d.jsx)(n.th,{children:"version"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Python"}),(0,d.jsx)(n.td,{children:"3.10"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"CANN"}),(0,d.jsx)(n.td,{children:"8.1.RC1"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"\u521b\u5efa-conda-\u73af\u5883",children:"\u521b\u5efa conda \u73af\u5883"}),"\n",(0,d.jsx)(n.p,{children:"\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728 Miniconda \u4e2d\u521b\u5efa\u65b0\u7684 conda \u73af\u5883\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"conda create --name roll python=3.10\nconda activate roll\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5b89\u88c5-torch--torch_npu",children:"\u5b89\u88c5 torch & torch_npu:"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u80fd\u5728 ROLL \u4e2d\u6b63\u5e38\u4f7f\u7528 torch \u548c torch_npu\uff0c\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5 torch \u548c torch_npu\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"# \u5b89\u88c5 torch \u7684 CPU \u7248\u672c\npip install torch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 --index-url https://download.pytorch.org/whl/cpu\n\n# \u5b89\u88c5 torch_npu\npip install torch_npu==2.5.1\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5b89\u88c5vllm--vllm-ascend",children:"\u5b89\u88c5vllm & vllm-ascend:"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u80fd\u591f\u5728 ROLL \u4e2d\u6b63\u5e38\u4f7f\u7528 vllm\uff0c\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1\u5b89\u88c5 vllm \u548c vllm-ascend\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"# vllm\ngit clone -b v0.8.4 --depth 1 https://github.com/vllm-project/vllm.git\ncd vllm\n\nVLLM_TARGET_DEVICE=empty pip install -v -e .\ncd ..\n"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"# vllm-ascend\ngit clone -b v0.8.4rc2 --depth 1 https://github.com/vllm-project/vllm-ascend.git\ncd vllm-ascend\n\nexport COMPILE_CUSTOM_KERNELS=1\npip install -e .\ncd ..\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u679c\u5728\u5b89\u88c5 vllm-ascend \u65f6\u9047\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u95ee\u9898\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"RuntimeError: CMake configuration failed: Command '['/pathto/miniconda3/envs/roll/bin/python3.10', '-m', 'pybind11', '--cmake']' returned non-zero exit status 2.\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u53ef\u5c1d\u8bd5\u5728 vllm-ascend \u76ee\u5f55\u4e0b setup.py \u6587\u4ef6 151-158 \u884c\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\u5e76\u91cd\u65b0\u8fdb\u884c\u7f16\u8bd1\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'try:\n    # if pybind11 is installed via pip\n    pybind11_cmake_path = (subprocess.check_output(\n        [python_executable, "-m", "pybind11",\n        "--cmakedir"]).decode().strip())\nexcept subprocess.CalledProcessError as e:\n    # else specify pybind11 path installed from source code on CI container\n    raise RuntimeError(f"CMake configuration failed: {e}")\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u5b89\u88c5-roll",children:"\u5b89\u88c5 ROLL"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"git clone https://github.com/alibaba/ROLL.git\ncd ROLL\npip install -r requirements_common.txt\npip install deepspeed==0.16.0\ncd ..\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e",children:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"software"}),(0,d.jsx)(n.th,{children:"description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"transformers"}),(0,d.jsx)(n.td,{children:"v4.52.4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"flash_attn"}),(0,d.jsx)(n.td,{children:"not supported"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"transformer-engine[pytorch]"}),(0,d.jsx)(n.td,{children:"not supported"})]})]})]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u652f\u6301\u901a\u8fc7 transformers \u4f7f\u80fd --flash_attention_2\uff0c transformers \u9700\u7b49\u4e8e 4.52.4\u7248\u672c\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u4e0d\u652f\u6301\u901a\u8fc7 flash_attn \u4f7f\u80fd flash attention \u52a0\u901f\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6682\u4e0d\u652f\u6301 transformer-engine[pytorch]"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"pip install transformers==4.52.4\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u5feb\u901f\u5f00\u59cb\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15",children:"\u5feb\u901f\u5f00\u59cb\uff0c\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15"}),"\n",(0,d.jsx)(n.p,{children:"\u6b63\u5f0f\u4f7f\u7528\u524d\uff0c\u5efa\u8bae\u60a8\u901a\u8fc7\u5bf9\u5355\u8282\u70b9\u6d41\u6c34\u7ebf\u7684\u8bad\u7ec3\u5c1d\u8bd5\u4ee5\u68c0\u9a8c\u73af\u5883\u51c6\u5907\u548c\u5b89\u88c5\u7684\u6b63\u786e\u6027\u3002\n\u7531\u4e8e\u76ee\u524d\u6682\u4e0d\u652f\u6301 Megatron-LM \u8bad\u7ec3\uff0c\u8bf7\u9996\u5148\u5c06\u5bf9\u5e94\u6587\u4ef6\u4e2d\nstrategy_args \u53c2\u6570\u4fee\u6539\u4e3a deepspeed \u9009\u9879\u3002"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u4f7f\u7528 shell \u6267\u884c\u5355\u8282\u70b9\u6d41\u6c34\u7ebf"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"bash examples/agentic_demo/run_agentic_pipeline_frozen_lake_single_node_demo.sh  \n"})}),"\n",(0,d.jsxs)(n.ol,{start:"2",children:["\n",(0,d.jsx)(n.li,{children:"\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u6267\u884c agentic pipeline"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"# \u786e\u4fdd\u5f53\u524d\u4f4d\u4e8eROLL\u9879\u76ee\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e0b\n# export PYTHONPATH=$(pwd):$PYTHONPATH\n\npython examples/start_agentic_pipeline.py \\\n        --config_path qwen2.5-0.5B-agentic \\\n        --config_name agentic_val_sokoban\n\n- ``--config_path`` \u2013 \u5305\u542b\u60a8\u7684YAML\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\u3002\n- ``--config_name`` \u2013 \u6587\u4ef6\u540d\uff08\u4e0d\u542b.yaml\u540e\u7f00\uff09\u3002\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u652f\u6301\u73b0\u72b6",children:"\u652f\u6301\u73b0\u72b6"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Feature"}),(0,d.jsx)(n.th,{children:"Example"}),(0,d.jsx)(n.th,{children:"Training Backend"}),(0,d.jsx)(n.th,{children:"Inference Backend"}),(0,d.jsx)(n.th,{children:"Hardware"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Agentic"}),(0,d.jsx)(n.td,{children:"examples/qwen2.5-0.5B-agentic/run_agentic_pipeline_sokoban.sh"}),(0,d.jsx)(n.td,{children:"DeepSpeed"}),(0,d.jsx)(n.td,{children:"vLLM"}),(0,d.jsx)(n.td,{children:"Atlas 900 A2 PODc"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Agentic-Rollout"}),(0,d.jsx)(n.td,{children:"examples/qwen2.5-0.5B-agentic/run_agentic_rollout_sokoban.sh"}),(0,d.jsx)(n.td,{children:"DeepSpeed"}),(0,d.jsx)(n.td,{children:"vLLM"}),(0,d.jsx)(n.td,{children:"Atlas 900 A2 PODc"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"DPO"}),(0,d.jsx)(n.td,{children:"examples/qwen2.5-3B-dpo_megatron/run_dpo_pipeline.sh"}),(0,d.jsx)(n.td,{children:"DeepSpeed"}),(0,d.jsx)(n.td,{children:"vLLM"}),(0,d.jsx)(n.td,{children:"Atlas 900 A2 PODc"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"RLVR"}),(0,d.jsx)(n.td,{children:"examples/qwen2.5-7B-rlvr_megatron/run_rlvr_pipeline.sh"}),(0,d.jsx)(n.td,{children:"DeepSpeed"}),(0,d.jsx)(n.td,{children:"vLLM"}),(0,d.jsx)(n.td,{children:"Atlas 900 A2 PODc"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u58f0\u660e",children:"\u58f0\u660e"}),"\n",(0,d.jsx)(n.p,{children:"ROLL \u4e2d\u63d0\u4f9b\u7684 Ascend \u652f\u6301\u4ee3\u7801\u7686\u4e3a\u53c2\u8003\u6837\u4f8b\uff0c\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u8bf7\u901a\u8fc7\u5b98\u65b9\u6b63\u5f0f\u9014\u5f84\u6c9f\u901a\uff0c\u8c22\u8c22\u3002"})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}}}]);